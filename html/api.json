{
	"openapi": "3.0.0",
	"info": {
		"title": "Nadybot API",
		"description": "This API provides access to Nadybot function in a REST API",
		"license": {
			"name": "GPL3",
			"url": "https://www.gnu.org/licenses/gpl-3.0.en.html"
		},
		"version": "5.0"
	},
	"servers": [
		{
			"url": "/api"
		}
	],
	"components": {
		"schemas": {
			"BasicSystemInformation": {
				"type": "object",
				"properties": {
					"bot_name": {
						"type": "string",
						"description": "Name of the bot character in AO"
					},
					"superadmin": {
						"type": "string",
						"nullable": true,
						"description": "Name of the character running the bot, null if not set"
					},
					"org": {
						"type": "string",
						"nullable": true,
						"description": "Name of the org this bot is in or null if not in an org"
					},
					"org_id": {
						"type": "integer",
						"nullable": true,
						"description": "ID of the org this bot is in or null if not in an org"
					},
					"bot_version": {
						"type": "string",
						"description": "Which Nadybot version are we running?"
					},
					"php_version": {
						"type": "string",
						"description": "Which PHP version are we running?"
					},
					"os": {
						"type": "string",
						"description": "Which operating system/kernel are we running?"
					},
					"db_type": {
						"type": "string",
						"description": "Which database type (mysql/sqlite) are we using?"
					}
				}
			},
			"MemoryInformation": {
				"type": "object",
				"properties": {
					"current_usage": {
						"type": "integer",
						"description": "Current memory usage in bytes"
					},
					"current_usage_real": {
						"type": "integer",
						"description": "Current memory usage in bytes including allocated system pages"
					},
					"peak_usage": {
						"type": "integer",
						"description": "Peak memory usage in bytes"
					},
					"peak_usage_real": {
						"type": "integer",
						"description": "Peak memory usage in bytes including allocated system pages"
					}
				}
			},
			"MiscSystemInformation": {
				"type": "object",
				"properties": {
					"using_chat_proxy": {
						"type": "boolean",
						"description": "Is the bot using a chat proxy for mass messages or more than 1000 friends"
					},
					"uptime": {
						"type": "integer",
						"description": "Number of seconds since the bot was started"
					}
				}
			},
			"ConfigStatistics": {
				"type": "object",
				"properties": {
					"active_tell_commands": {
						"type": "integer",
						"description": "Number of commands activated for use with /tell"
					},
					"active_priv_commands": {
						"type": "integer",
						"description": "Number of commands activated for use in the private channel"
					},
					"active_org_commands": {
						"type": "integer",
						"description": "Number of commands activated for use in the org channel"
					},
					"active_subcommands": {
						"type": "integer",
						"description": "Number of subcommands activated"
					},
					"active_aliases": {
						"type": "integer",
						"description": "Number of aliases"
					},
					"active_events": {
						"type": "integer",
						"description": "Number of currently active events"
					},
					"active_help_commands": {
						"type": "integer",
						"description": "Number of active help texts for commands"
					}
				}
			},
			"SystemStats": {
				"type": "object",
				"properties": {
					"buddy_list_size": {
						"type": "integer",
						"description": "How many characters are currently on the friendlist"
					},
					"max_buddy_list_size": {
						"type": "integer",
						"description": "Maximum allowed characters for the friendlist"
					},
					"priv_channel_size": {
						"type": "integer",
						"description": "How many people are currently on the bot's private channel"
					},
					"org_size": {
						"type": "integer",
						"description": "How many people are in the bot's org? 0 if not in an org"
					},
					"charinfo_cache_size": {
						"type": "integer",
						"description": "How many character infos are currently cached?"
					},
					"chatqueue_length": {
						"type": "integer",
						"description": "How many messages are waiting to be sent?"
					}
				}
			},
			"ChannelInfo": {
				"type": "object",
				"properties": {
					"name": {
						"type": "string",
						"description": "The name of the public channel"
					},
					"id": {
						"type": "integer",
						"description": "The ID the game uses for this channel"
					}
				}
			},
			"SystemInformation": {
				"type": "object",
				"properties": {
					"basic": {
						"$ref": "#/components/schemas/BasicSystemInformation",
						"description": "Basic information like OS"
					},
					"memory": {
						"$ref": "#/components/schemas/MemoryInformation",
						"description": "Memory statistics"
					},
					"misc": {
						"$ref": "#/components/schemas/MiscSystemInformation",
						"description": "Information not fitting any other category"
					},
					"config": {
						"$ref": "#/components/schemas/ConfigStatistics",
						"description": "Statistics about some configurations"
					},
					"stats": {
						"$ref": "#/components/schemas/SystemStats",
						"description": "General bot statistics"
					},
					"channels": {
						"type": "array",
						"description": "Which channels is the bot listening to",
						"items": {
							"$ref": "#/components/schemas/ChannelInfo"
						}
					}
				}
			},
			"Player": {
				"type": "object",
				"properties": {
					"charid": {
						"type": "integer",
						"description": "The character ID as used by Anarchy Online"
					},
					"first_name": {
						"type": "string",
						"description": "The character's first name (the name before $name)"
					},
					"name": {
						"type": "string",
						"description": "The character's name as it appears in the game"
					},
					"last_name": {
						"type": "string",
						"description": "The character's last name (the name after $name)"
					},
					"level": {
						"type": "integer",
						"nullable": true,
						"description": "What level (1-220) is the characer or null if unknown"
					},
					"breed": {
						"type": "string",
						"description": "Any of Nano, Solitus, Atrox or Opifex. Also empty string if unknown"
					},
					"gender": {
						"type": "string",
						"description": "Male, Female, Neuter or an empty string if unknown"
					},
					"faction": {
						"type": "string",
						"description": "Omni, Clan, Neutral or an empty string if unknown"
					},
					"profession": {
						"type": "string",
						"nullable": true,
						"description": "The long profession name (e.g. \"Enforcer\", not \"enf\" or \"enfo\") or an empty string if unknown"
					},
					"prof_title": {
						"type": "string",
						"description": "The title-level title for the profession of this player For example \"The man\", \"Don\" or empty if unknown."
					},
					"ai_rank": {
						"type": "string",
						"description": "The name of the ai_level as a rank or empty string if unknown"
					},
					"ai_level": {
						"type": "integer",
						"nullable": true,
						"description": "AI level of this player or null if unknown"
					},
					"org_id": {
						"type": "integer",
						"nullable": true,
						"description": "The id of the org this player is in or null if none or unknown"
					},
					"org": {
						"type": "string",
						"nullable": true,
						"description": "The name of the org this player is in or null if none/unknown"
					},
					"org_rank": {
						"type": "string",
						"nullable": true,
						"description": "The name of the rank the player has in their org (Veteran, Apprentice) or null if not in an org or unknown"
					},
					"org_rank_id": {
						"type": "integer",
						"nullable": true,
						"description": "The numeric rank of the player in their org or null if not in an org/unknown"
					},
					"dimension": {
						"type": "integer",
						"nullable": true,
						"description": "In which dimension (RK server) is this character? 4 for test, 5 for RK5, 6 for RK19"
					},
					"head_id": {
						"type": "integer",
						"nullable": true,
						"description": "Which head is the player using"
					},
					"pvp_rating": {
						"type": "integer",
						"nullable": true,
						"description": "Numeric PvP-rating of the player (1-7) or null if unknown"
					},
					"pvp_title": {
						"type": "string",
						"nullable": true,
						"description": "Name of the player's PvP title derived from their $pvp_rating or null if unknown"
					},
					"last_update": {
						"type": "integer",
						"nullable": true,
						"description": "Unix timestamp of the last update of these data"
					}
				},
				"description": "This represents the data the bot stores about a player in the cache and database"
			},
			"OnlinePlayer": {
				"allOf": [
					{
						"$ref": "#/components/schemas/Player"
					},
					{
						"type": "object",
						"properties": {
							"afk_message": {
								"type": "string",
								"description": "The AFK message of the player or an empty string"
							},
							"main_character": {
								"type": "string",
								"description": "The name of the main character, or the same as $name if this is the main character of the player"
							},
							"online": {
								"type": "boolean",
								"description": "True if this player is currently online, false otherwise"
							}
						},
						"description": "This represents a single player in the online list"
					}
				]
			},
			"OnlinePlayers": {
				"type": "object",
				"properties": {
					"org": {
						"type": "array",
						"description": "All players online in the org",
						"items": {
							"$ref": "#/components/schemas/OnlinePlayer"
						}
					},
					"private_channel": {
						"type": "array",
						"description": "All players online in the private channel",
						"items": {
							"$ref": "#/components/schemas/OnlinePlayer"
						}
					}
				},
				"description": "This is the list of all players considered to be online by the bot"
			}
		},
		"securitySchemes": {
			"basicAuth": {
				"type": "http",
				"scheme": "basic"
			}
		}
	},
	"paths": {
		"/setting/{key}": {
			"parameters": [
				{
					"name": "key",
					"required": true,
					"in": "path",
					"schema": {
						"type": "string"
					}
				}
			],
			"get": {
				"security": [
					{
						"basicAuth": []
					}
				],
				"description": "Get the value of a setting",
				"responses": {
					"200": {
						"description": "The stored value",
						"content": {
							"application/json": {
								"schema": {
									"type": "string"
								}
							}
						}
					},
					"204": {
						"description": "No value stored"
					}
				}
			},
			"post": {
				"security": [
					{
						"basicAuth": []
					}
				],
				"description": "Create a new setting",
				"responses": {
					"201": {
						"description": "The new setting was stored successfully"
					},
					"409": {
						"description": "There is already a setting stored"
					},
					"415": {
						"description": "You tried to pass more than just a simple string"
					}
				},
				"requestBody": {
					"description": "The data you want to store",
					"required": true,
					"content": {
						"application/json": {
							"schema": {
								"type": "string"
							}
						}
					}
				}
			},
			"put": {
				"security": [
					{
						"basicAuth": []
					}
				],
				"description": "Store a setting",
				"responses": {
					"204": {
						"description": "The new setting was stored successfully"
					},
					"415": {
						"description": "You tried to pass more than just a simple string"
					}
				},
				"requestBody": {
					"description": "The data you want to store",
					"required": true,
					"content": {
						"application/json": {
							"schema": {
								"type": "string"
							}
						}
					}
				}
			},
			"delete": {
				"security": [
					{
						"basicAuth": []
					}
				],
				"description": "Delete a setting",
				"responses": {
					"204": {
						"description": "The new setting was deleted successfully"
					},
					"409": {
						"description": "No setting found for that key"
					}
				}
			}
		},
		"/sysinfo": {
			"parameters": [],
			"get": {
				"security": [
					{
						"basicAuth": []
					}
				],
				"description": "Get system information",
				"responses": {
					"200": {
						"description": "Some basic system information",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/SystemInformation"
								}
							}
						}
					}
				}
			}
		},
		"/online": {
			"parameters": [],
			"get": {
				"security": [
					{
						"basicAuth": []
					}
				],
				"description": "Get a list of all people online in all linked channels",
				"responses": {
					"200": {
						"description": "A list of online players",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/OnlinePlayers"
								}
							}
						}
					}
				}
			}
		}
	}
}